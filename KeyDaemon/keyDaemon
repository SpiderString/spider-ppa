--Allows you to make complex keybinds
--Runs scripts in a separate thread
run("spiderLib")
local keybinds={}
local args={...}
function unpackKeycode(keybind)
  return split(keybind, "+")
end
function addHotKey(keycode, action)
  if type(keycode) == "string" and type(action) == "string" then
    table.insert(keybinds, {keycode, false, "~/macros/"..action})
  end
end
--Add Hot Keys Here
--E.G. addHotKey("LCONTROL+C", "folder/myscript")



if KEYDAEMONRUNNING==nil then KEYDAEMONRUNNING=false end
KEYDAEMONRUNNING=not KEYDAEMONRUNNING
if args[2]=="JoinWorld" then KEYDAEMONRUNNING=true
elseif args[2]=="LeaveWorld" then KEYDAEMONRUNNING=false end

while KEYDAEMONRUNNING do
  for id, keybind in pairs(keybinds) do
    local doAction=true
    local keys=unpackKeycode(keybind[1])
    for index, key in pairs(keys) do
      if index ~= "length" then
        if not isKeyDown(key) then doAction = false end
      end
    end
    if doAction and not keybind[2] then
      runThread(keybind[3])
      keybind[2]=true
    end
    if not isKeyDown(keys[keys["length"]]) then
      keybind[2]=false
    end
  end
end
